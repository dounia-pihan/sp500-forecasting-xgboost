# ðŸ“ˆ S&P 500 Forecasting with Machine Learning (*personal project*)

![Python](https://img.shields.io/badge/Python-3.10+-blue)
![NumPy](https://img.shields.io/badge/Library-NumPy-013243)
![pandas](https://img.shields.io/badge/Library-pandas-150458)
![Matplotlib](https://img.shields.io/badge/Visualization-Matplotlib-11557c)
![scikit-learn](https://img.shields.io/badge/Framework-scikit--learn-F7931E)
![XGBoost](https://img.shields.io/badge/Model-XGBoost-orange)
![ta](https://img.shields.io/badge/TechIndicator-lib%20ta-lightgrey)
![YahooFinance](https://img.shields.io/badge/Data-Yahoo%20Finance-2C7BB6)
![License](https://img.shields.io/badge/License-MIT-yellow)

This project builds a reproducible **next-day price prediction model** for the **S&P 500 index** using public financial data from Yahoo Finance.  
It combines **feature engineering**, **time-series modeling** (XGBoost), and an **independent backtest** to illustrate the gap between predictive accuracy and market performance.

---

## Overview

| File | Description |
|------|--------------|
| [`sp500_model.ipynb`](./sp500_model.ipynb) | Builds and evaluates the ML model (data loading, feature engineering, model training, metrics, and next-day prediction). |
| [`sp500_backtest.ipynb`](./sp500_backtest.ipynb) | Independent simulation of basic trading strategies using the modelâ€™s predictions (educational purpose only). |
| [`/data`](./data) | CSV exports generated by the model and used by the backtest notebook. |
| [`/assets`](./assets) | Visual outputs used in this project. |

---

## Methodology

1. **Data Collection** â€” Yahoo Finance data for:
   - S&P 500 (^GSPC)
   - Volatility Index (VIX)
   - U.S. 10-year Treasury yield (TNX)
   - Brent crude oil (BZ=F)
   - Gold (GC=F)

2. **Feature Engineering**
   - Technical indicators: SMA, EMA, RSI, MACD, Bollinger Bands.
   - Lagged returns and volatility metrics.
   - Exogenous changes in macro indicators.

3. **Modeling**
   - Algorithm: `XGBoost Regressor`
   - Target: next-day return (`t+1`)
   - Evaluation metrics: MAE, RMSE, MAPE, Directional Accuracy.
   - Baselines: zero return & 5-day moving average.

4. **Backtesting (educational only)**
   - Strategy A: threshold on predicted return.
   - Strategy B: proportional exposure (sizing).
   - Volatility filter using VIX and transaction costs.

---

## ðŸ“ˆ Key Results

| Model | MAE | RMSE | MAPE (%) | Directional Accuracy |
|-------|------|------|-----------|----------------------|
| XGBoost | ~25 | ~35 | ~0.7% | ~55% |

> IMAGES

> The model captures the general price direction but cannot outperform the market after transaction costs â€” a realistic outcome for broad indices.


---

## Backtest â€” Cumulative Performance

<details>
<summary>ðŸ“Š View backtest performance (optional)</summary>

![Backtest Results](assets/sp500_backtest_results.png)

The backtest compares:
- **Buy & Hold (blue):** market performance,
- **Strategy A (orange):** threshold-based signals,
- **Strategy B (green):** dynamic position sizing.

While the model reproduces price movements, it does not outperform the market in this simple form â€” consistent with efficient market theory.

</details

---

## Interpretation

 **What this shows**
- The model accurately tracks the S&P 500's movements, with an average relative error below 1% over the test period.
- Predicting the next-day return (rather than the absolute price) makes the series more stationary, improving model stability and generalization (validated by walk-forward CV).

** Limitations (scope of the project)**
- On a broad, efficient index like the S&P 500, predictive signals are naturally weak and rarely translate into consistent outperformance once transaction costs are included.
- The projectâ€™s goal is to demonstrate a robust ML workflow â€” from data collection to modeling and evaluation â€” rather than to design a trading strategy.

---

## Tech Stack

- **Python 3.10+**
- `pandas`, `numpy`, `matplotlib`
- `yfinance` for financial data
- `xgboost` and `scikit-learn` for modeling
- `ta` for technical indicators

---

## License
MIT â€“ Free to use and share with attribution. 

